(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{511:function(e,t,a){e.exports=a(833)},516:function(e,t,a){},833:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(15),s=a.n(i),o=(a(516),a(27)),l=a(24),c=a(43),u=a(44),d=a(45),h=a(159),m=a(26),f=a(29),p=a(64),v=a.n(p);function y(e,t){var a=new Date(e).getTime(),n=new Date(t).getTime()-a;return Math.round(n/864e5)}var _=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).default_start_date="2017-01-01",a.default_end_date="2017-01-07",a.stats_daily_url="https://xianliflc-ws-product-python.glitch.me/stats/daily",a.stats_hourly_url="https://xianliflc-ws-product-python.glitch.me/stats/hourly",a.filter_type="daily",a.state={stats:[]},a.myRef=r.a.createRef(),a.myRef2=r.a.createRef(),a.filter_type_ref=r.a.createRef(),a.changeDate=a.changeDate.bind(Object(m.a)(a)),a.changeType=a.changeType.bind(Object(m.a)(a)),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"getData",value:function(e,t){var a=this;if(y(e,t)+1>7)alert("Range should be maximum of 7 days");else{var n="daily"===this.filter_type?this.stats_daily_url:this.stats_hourly_url;v.a.get("".concat(n,"?start_date=").concat(e,"&end_date=").concat(t)).then((function(e){e.data.data.error&&console.error(e.data.data.error),e.data.data.forEach((function(e){e.impressions=Math.round(e.impressions/100),e.revenue=Math.round(e.revenue)}));var t=e.data.data;a.setState({stats:t})}))}}},{key:"componentDidMount",value:function(){this.getData(this.default_start_date,this.default_end_date,this.filter_type)}},{key:"changeDate",value:function(e){e.preventDefault(),console.log(this.filter_type_ref,this.filter_type_ref.current.f),this.getData(this.myRef.current.value,this.myRef2.current.value)}},{key:"changeType",value:function(e){this.filter_type=e.target.value}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:this.changeDate},r.a.createElement("div",null,r.a.createElement("input",{type:"date",ref:this.myRef}),r.a.createElement("input",{type:"date",ref:this.myRef2})),r.a.createElement("div",{ref:this.filter_type_ref,onChange:this.changeType},r.a.createElement("input",{type:"radio",name:"type",value:"daily"})," daily",r.a.createElement("input",{type:"radio",name:"type",value:"hourly"})," hourly"),r.a.createElement("button",{type:"submit"}," Submit ")),r.a.createElement(f.c,{width:1e3,height:900,data:this.state.stats,margin:{top:50,right:80,bottom:25,left:50}},r.a.createElement(f.b,{stroke:"#f5f5f5"}),r.a.createElement(f.g,{dataKey:"daily"===this.filter_type?"date":"hour",label:{value:"daily"===this.filter_type?"Day":"Hour",position:"insideBottomRight",offset:0}}),r.a.createElement(f.h,{label:{value:"impressions (x100)",angle:-90,position:"insideTopLeft"}}),r.a.createElement(f.f,null),r.a.createElement(f.d,null),r.a.createElement(f.e,{type:"monotone",dataKey:"impressions",stroke:"#8884d8"}),r.a.createElement(f.e,{dataKey:"clicks",barSize:20,stroke:"#413ea0"}),r.a.createElement(f.e,{type:"monotone",dataKey:"revenue",stroke:"#ff7300"})))}}]),t}(n.PureComponent),g=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).default_start_date="2017-01-01",a.default_end_date="2017-01-03",a.default_start_date2="2017-01-04",a.default_end_date2="2017-01-06",a.stats_daily_url="https://xianliflc-ws-product-python.glitch.me/stats/daily",a.stats_hourly_url="https://xianliflc-ws-product-python.glitch.me/stats/hourly",a.filter_type="daily",a.metrics="revenue",a.state={stats:[]},a.start_date_ref=r.a.createRef(),a.end_date_ref=r.a.createRef(),a.start_date_ref2=r.a.createRef(),a.end_date_ref2=r.a.createRef(),a.filter_type_ref=r.a.createRef(),a.metrics_ref=r.a.createRef(),a.changeDate=a.changeDate.bind(Object(m.a)(a)),a.changeType=a.changeType.bind(Object(m.a)(a)),a.changeMetrics=a.changeMetrics.bind(Object(m.a)(a)),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"getData",value:function(e,t,a,n){var r=this,i=y(e,t)+1;if(i>5)alert("Range should be maximum of 5 days");else{var s=y(a,n)+1;if(s>5)alert("Compared date range should be maximum of 5 days");else if(i===s){var o="daily"===this.filter_type?this.stats_daily_url:this.stats_hourly_url,l=v.a.get("".concat(o,"?start_date=").concat(e,"&end_date=").concat(t)),c=v.a.get("".concat(o,"?start_date=").concat(a,"&end_date=").concat(n));v.a.all([l,c]).then(v.a.spread((function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];t[0].data.data.error&&console.error(t[0].data.data.error),t[1].data.data.error&&console.error(t[1].data.data.error),t[0].data.data.forEach((function(e){e.impressions=Math.round(e.impressions/1e3),e.revenue=Math.round(e.revenue)}));var n=t[0].data.data;t[1].data.data.forEach((function(e,t){n[t].impressions2=Math.round(e.impressions/1e3),n[t].revenue2=Math.round(e.revenue),n[t].clicks2=e.clicks})),r.setState({stats:n})})))}else alert("Compared date ranges do not have the same length")}}},{key:"componentDidMount",value:function(){this.getData(this.default_start_date,this.default_end_date,this.default_start_date2,this.default_end_date2)}},{key:"changeDate",value:function(e){e.preventDefault(),console.log(this.filter_type_ref,this.filter_type_ref.current.f),this.getData(this.start_date_ref.current.value,this.end_date_ref.current.value,this.start_date_ref2.current.value,this.end_date_ref2.current.value)}},{key:"changeType",value:function(e){this.filter_type=e.target.value}},{key:"changeMetrics",value:function(e){this.metrics=e.target.value}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:this.changeDate},r.a.createElement("div",null,r.a.createElement("input",{type:"date",ref:this.start_date_ref}),r.a.createElement("input",{type:"date",ref:this.end_date_ref})),"compared to",r.a.createElement("div",null,r.a.createElement("input",{type:"date",ref:this.start_date_ref2}),r.a.createElement("input",{type:"date",ref:this.end_date_ref2})),r.a.createElement("div",{ref:this.metrics_ref,onChange:this.changeMetrics},r.a.createElement("input",{type:"radio",name:"metrics",value:"clicks"})," clicks",r.a.createElement("input",{type:"radio",name:"metrics",value:"impressions"})," impressions",r.a.createElement("input",{type:"radio",name:"metrics",value:"revenue"})," revenue"),r.a.createElement("div",{ref:this.filter_type_ref,onChange:this.changeType},r.a.createElement("input",{type:"radio",name:"type",value:"daily"})," daily",r.a.createElement("input",{type:"radio",name:"type",value:"hourly"})," hourly"),r.a.createElement("button",{type:"submit"}," Submit ")),r.a.createElement(f.c,{width:1200,height:1e3,data:this.state.stats,margin:{top:50,right:80,bottom:25,left:50}},r.a.createElement(f.b,{stroke:"#f5f5f5"}),r.a.createElement(f.g,{dataKey:"daily"===this.filter_type?"date":"hour",label:{value:"daily"===this.filter_type?"Day":"Hour",position:"insideBottomRight",offset:0}}),r.a.createElement(f.h,{label:{value:this.metrics,angle:-90,position:"insideTopLeft"}}),r.a.createElement(f.f,null),r.a.createElement(f.d,null),r.a.createElement(f.a,{dataKey:this.metrics,barSize:12,fill:"#413ea0"}),r.a.createElement(f.a,{dataKey:this.metrics+"2",barSize:12,fill:"#ff7300"})))}}]),t}(n.PureComponent),b=a(46),E=a(472),k=a.n(E),O=a(211),w=a(427),j=a(276),x=a(280),R=a.n(x),S=a(5),D=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleTextChange=function(e){a.props.onSearch(e.target.value)},a.onKeyDown=function(e){27===e.keyCode&&a.props.onHide()},a.onKeyUp=function(e){8===e.keyCode&&""===e.target.value&&(a.handleTextChange(e),a.props.clear())},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.onKeyDown,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.onKeyDown,!1)}},{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.options,i=t.onHide,s=t.searchText;return r.a.createElement(O.a,{appear:!0,in:!0,timeout:300},r.a.createElement("div",{className:a.main,ref:function(t){return e.rootRef=t}},r.a.createElement(w.a,{placeholder:"Search...",className:a.searchText,InputProps:{"aria-label":n.textLabels.toolbar.search},value:s||"",onChange:this.handleTextChange,onKeyUp:this.onKeyUp,fullWidth:!0,inputRef:function(t){return e.searchField=t}}),r.a.createElement(j.a,{className:a.clearIcon,onClick:i},r.a.createElement(R.a,null))))}}]),t}(r.a.Component),C=Object(S.a)((function(e){return{main:{display:"flex",flex:"1 0 auto"},searchText:{flex:"0.8 0"},clearIcon:{"&:hover":{color:e.palette.error.main}}}}),{name:"CustomSearchRender"})(D);function M(e){console.log(e),this.setState({searched_rows:e})}var N=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={style:{backgroundColor:"#ededed"},searched_rows:"",clear:!1},a.myRef=r.a.createRef(),M=M.bind(Object(m.a)(a)),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({searched_rows:e.query})}},{key:"shouldComponentUpdate",value:function(){return!0}},{key:"render",value:function(){return r.a.createElement("tr",{ref:this.myRef,style:this.props.query&&""!==this.props.query&&this.props.poi_name.toLowerCase().toString().indexOf(this.props.query.toLowerCase())>=0?{backgroundColor:"#ff00ff"}:this.state.style},r.a.createElement("td",null),r.a.createElement("td",null,this.props.poi_name),r.a.createElement("td",null,this.props.events),r.a.createElement("td",null,this.props.revenue))}}]),t}(r.a.Component),T=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).poi_url="https://xianliflc-ws-product-python.glitch.me/poi?include=revenue,events",a.columns=[{name:"POI Name",searchable:!0},{name:"No. of events",searchable:!1},{name:"Revenue $",searchable:!1}],a.options={filter:!0,selectableRows:!0,selectableRowsHeader:!1,filterType:"dropdown",responsive:"stacked",rowsPerPage:20,page:1,print:!1,download:!1,rowsPerPageOptions:[],caseSensitive:!1,onTableChange:function(e,t){},customSearch:function(e,t,n){return a.highlightRow(e),!0},customSearchRender:function(e,t,n,i){return r.a.createElement(C,{searchText:e,onSearch:t,onHide:n,options:i,clear:a.clearSearch.bind(Object(m.a)(a))})},customRowRender:function(e){var t=Object(b.a)(e,3),n=t[0],i=t[1],s=t[2];return r.a.createElement(N,{key:n,poi_name:n,events:i,revenue:s,query:a.state.searched_rows})}},a.state={poi:[]},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"clearSearch",value:function(){this.setState({clear:!0,searched_rows:""})}},{key:"highlightRow",value:function(e){this.setState({searched_rows:e,clear:!1})}},{key:"getData",value:function(){var e=this;v.a.get("".concat(this.poi_url)).then((function(t){var a=[];t.data.data.error&&console.error(t.data.data.error),t.data.data.forEach((function(e){a.push([e["Poi Name"],e.events,e.revenue])})),e.setState({poi:a})}))}},{key:"componentDidMount",value:function(){this.getData()}},{key:"render",value:function(){return r.a.createElement(k.a,{title:"Poi-revenue list",data:this.state.poi,columns:this.columns,options:this.options})}}]),t}(r.a.Component),P=a(723),I=P.compose,K=P.withProps,L=P.withHandlers,A=a(725),H=A.withScriptjs,W=A.withGoogleMap,z=A.GoogleMap,U=A.Marker,q=a(829).MarkerClusterer,B=I(K({googleMapURL:"https://maps.googleapis.com/maps/api/js?key=AIzaSyAnKu85VSoJJASFOAP2K-sgQbsu6Hm9PoU&v=3.exp&libraries=geometry,drawing,places",loadingElement:r.a.createElement("div",{style:{height:"100%"}}),containerElement:r.a.createElement("div",{style:{height:"400px"}}),mapElement:r.a.createElement("div",{style:{height:"100%"}})}),L({onMarkerClustererClick:function(){return function(e){}}}),H,W)((function(e){return r.a.createElement(z,{defaultZoom:4,defaultCenter:{lat:43,lng:-79}},r.a.createElement(q,{onClick:e.onMarkerClustererClick,averageCenter:!0,enableRetinaIcons:!0,gridSize:60},e.markers.map((function(e){return r.a.createElement(U,{key:e.poi_id,position:{lat:e.lat,lng:e.lon}})}))))})),J={composedWrapper:{composed:_,ComparedMetrics:g},dataTableWapper:{DataTable:T},clusterMap:{ClusterMap:function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).poi_url="https://xianliflc-ws-product-python.glitch.me/poi?include=revenue,events",a.default_min_revenue=0,a.default_max_revenue=1e9,a.default_min_events=0,a.default_max_events=1e9,a.max_revenue_ref=r.a.createRef(),a.min_revenue_ref=r.a.createRef(),a.max_events_ref=r.a.createRef(),a.min_events_ref=r.a.createRef(),a.filterServer=a.filterServer.bind(Object(m.a)(a)),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){this.setState({markers:[]})}},{key:"componentDidMount",value:function(){this.getData(this.default_min_revenue,this.default_max_revenue,this.default_min_events,this.default_max_events)}},{key:"getData",value:function(e,t,a,n){var r=this;v.a.get("".concat(this.poi_url,"&min_revenue=").concat(e,"&max_revenue=").concat(t,"&min_events=").concat(a,"&max_events=").concat(n)).then((function(e){e.data.data.error&&(alert(JSON.stringify(e.data.data.error)),console.error(e.data.data.error)),r.setState({markers:e.data.data})}))}},{key:"filterServer",value:function(e){e.preventDefault(),this.getData(isNaN(parseInt(this.min_revenue_ref.current.value))?this.default_min_revenue:parseInt(this.min_revenue_ref.current.value),isNaN(parseInt(this.max_revenue_ref.current.value))?this.default_max_revenue:parseInt(this.max_revenue_ref.current.value),isNaN(parseInt(this.min_events_ref.current.value))?this.default_min_events:parseInt(this.min_events_ref.current.value),isNaN(parseInt(this.max_events_ref.current.value))?this.default_max_events:parseInt(this.max_events_ref.current.value))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:this.filterServer},"Min revenue ",r.a.createElement("input",{type:"text",ref:this.min_revenue_ref}),"Max revenue ",r.a.createElement("input",{type:"text",ref:this.max_revenue_ref}),"Min events ",r.a.createElement("input",{type:"text",ref:this.min_events_ref}),"Max events ",r.a.createElement("input",{type:"text",ref:this.max_events_ref}),r.a.createElement("button",{type:"submit"}," Submit ")),r.a.createElement(B,{markers:this.state.markers}))}}]),t}(r.a.PureComponent)}},Z=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"renderList",value:function(){var e=Object.keys(J).map((function(e){var t=J[e],a=Object.keys(t).map((function(t){return r.a.createElement("li",{key:"component-".concat(t)},r.a.createElement(h.b,{to:{pathname:"/",search:"?group=".concat(e,"&component=").concat(t)}},t))}));return r.a.createElement("div",{key:"group-".concat(e),className:"component-list-container"},r.a.createElement("p",{className:"group-name"},e),r.a.createElement("ul",{className:"component-list"},a))}));return r.a.createElement("div",{className:"component-list-wrapper"},r.a.createElement("p",{className:"title"},"components"),e)}},{key:"renderPageDetail",value:function(e,t){return r.a.createElement("div",{className:"component-wrapper"},r.a.createElement("p",{className:"back"},r.a.createElement(h.b,{to:{pathname:"/"}},"Back to homepage")),r.a.createElement("p",{className:"title"},t),J[e]&&J[e][t]?r.a.createElement(J[e][t]):null)}},{key:"render",value:function(){var e=this.props.location.search,t=/group=([a-zA-Z]+)/.exec(e),a=/component=([a-zA-Z]+)/.exec(e);return t&&2===t.length&&a&&2===a.length?this.renderPageDetail(t[1],a[1]):this.renderList()}}]),t}(n.Component),F=a(93);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(h.a,null,r.a.createElement(F.a,{path:"/",component:Z})),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[511,1,2]]]);
//# sourceMappingURL=main.4d0ee188.chunk.js.map